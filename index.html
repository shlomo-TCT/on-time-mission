<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>On-Time Progress</title>

<style>
:root{
  --bg1:#0a1228;
  --bg2:#0b2f44;
  --bg3:#1b3f8a;

  --text:#eef3ff;
  --muted:#b8c6ff;
  --muted2:#95a4d8;

  --accent1:#22d3ee;
  --accent2:#60a5fa;
  --accent3:#a78bfa;
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: system-ui, -apple-system, "Segoe UI", Roboto;
  color:var(--text);
  background:
    radial-gradient(900px 600px at 50% -10%, rgba(96,165,250,.35), transparent 60%),
    radial-gradient(700px 500px at 80% 10%, rgba(167,139,250,.25), transparent 60%),
    linear-gradient(180deg, var(--bg3), var(--bg2), var(--bg1));
}

/* ───── HERO ───── */
.hero{
  padding:64px 20px 48px;
  text-align:center;
}

.logo-wrap{
  width:96px;
  height:96px;
  margin:0 auto 18px;
  border-radius:28px;
  background:
    radial-gradient(circle at top left, rgba(255,255,255,.45), transparent 60%),
    linear-gradient(135deg, var(--accent1), var(--accent2), var(--accent3));
  display:flex;
  align-items:center;
  justify-content:center;
}

.logo-wrap img{
  width:70%;
  height:70%;
  object-fit:contain;
}

.hero h1{
  margin:0;
  font-size:28px;
  font-weight:800;
}

.hero p{
  margin:10px 0 0;
  font-size:15px;
  color:var(--muted);
}

.date-range{
  margin-top:14px;
  font-size:13px;
  color:var(--muted2);
}

/* ───── CONTENT ───── */
.main{
  max-width:1100px;
  margin:0 auto;
  padding:0 20px 80px;
}

/* ───── STATS STRIP ───── */
.stats{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:24px;
  margin:36px 0 28px;
  text-align:center;
}

.stat .k{
  font-size:13px;
  color:var(--muted2);
}

.stat .v{
  margin-top:6px;
  font-size:26px;
  font-weight:800;
}

@media(max-width:800px){
  .stats{ grid-template-columns:repeat(2,1fr); }
}

/* ───── PROGRESS ───── */
.progress{
  max-width:600px;
  margin:0 auto 48px;
}

.bar{
  height:16px;
  border-radius:999px;
  background:rgba(255,255,255,.15);
  overflow:hidden;
}

.fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,var(--accent1),var(--accent2),var(--accent3));
}

.status{
  margin-top:12px;
  text-align:center;
  font-weight:600;
  color:var(--muted);
}

/* ───── CALENDAR ───── */
.calendar-wrap{
  margin-top:24px;
}

.week-head{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  margin-bottom:10px;
}

.week-head div{
  text-align:center;
  font-size:13px;
  color:var(--muted2);
}

.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:14px;
}

.day{
  padding:18px 0;
  border-radius:18px;
  background:rgba(255,255,255,.08);
  text-align:center;
  font-size:18px;
  font-weight:800;
}

.rest{ opacity:.45; }

.checked{
  background:linear-gradient(135deg, var(--accent1), var(--accent2));
  color:#06131f;
}

.today{
  outline:3px solid rgba(34,211,238,.6);
  outline-offset:3px;
}

@media(max-width:520px){
  .day{ font-size:16px; padding:16px 0; }
}
</style>
</head>

<body>

<!-- HERO -->
<section class="hero">
  <div class="logo-wrap">
    <img src="logo.png" alt="">
  </div>
  <h1>On-Time Goal</h1>
  <p>Here you can see my progress toward my goal</p>
  <div class="date-range" id="window"></div>
</section>

<!-- MAIN CONTENT -->
<section class="main">

  <!-- STATS -->
  <div class="stats">
    <div class="stat">
      <div class="k">On-time days</div>
      <div class="v" id="count"></div>
    </div>
    <div class="stat">
      <div class="k">Mission length</div>
      <div class="v">40 days</div>
    </div>
    <div class="stat">
      <div class="k">Buffer remaining</div>
      <div class="v" id="buffer"></div>
    </div>
    <div class="stat">
      <div class="k">Rest days</div>
      <div class="v">Fri + Shabbat</div>
    </div>
  </div>

  <!-- PROGRESS -->
  <div class="progress">
    <div class="bar"><div class="fill" id="fill"></div></div>
    <div class="status">⚡ In progress</div>
  </div>

  <!-- CALENDAR -->
  <div class="calendar-wrap">
    <div class="week-head">
      <div>Sun</div><div>Mon</div><div>Tue</div>
      <div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
    </div>
    <div class="calendar" id="cal"></div>
  </div>

</section>

<script>
const START = new Date("2026-01-12");
const DAYS = 40;
const GOAL = 35;

const cal = document.getElementById("cal");
const count = document.getElementById("count");
const fill = document.getElementById("fill");
const bufferEl = document.getElementById("buffer");
const windowEl = document.getElementById("window");

function endDate(){
  const e = new Date(START);
  e.setDate(e.getDate()+DAYS-1);
  return e;
}

function build(checked){
  cal.innerHTML="";
  const offset = START.getDay();
  for(let i=0;i<offset;i++){
    const s=document.createElement("div");
    s.style.visibility="hidden";
    cal.appendChild(s);
  }

  const todayKey = new Date().toISOString().slice(0,10);

  for(let i=0;i<DAYS;i++){
    const d=new Date(START);
    d.setDate(d.getDate()+i);
    const key=d.toISOString().slice(0,10);

    const div=document.createElement("div");
    div.className =
      "day" +
      (checked.includes(key) ? " checked" : "") +
      (key === todayKey ? " today" : "") +
      ((d.getDay()===5 || d.getDay()===6) ? " rest" : "");

    div.textContent=d.getDate();
    cal.appendChild(div);
  }
}

async function load(){
  const r = await fetch("progress.json?t="+Date.now());
  const j = await r.json();
  const checked = j.checkedDays || [];

  count.textContent = `${checked.length} / ${GOAL}`;
  fill.style.width = Math.min(100,(checked.length/GOAL)*100) + "%";

  const daysElapsed =
    Math.floor((Date.now() - START) / (1000*60*60*24)) + 1;
const bufferMax = DAYS - GOAL;

const bufferLeft = Math.max(
  0,
  bufferMax - (daysElapsed - checked.length)
);

// ✅ cap it so it can NEVER show above 5
bufferEl.textContent = Math.min(bufferMax, bufferLeft);

  build(checked);

  const e=endDate();
  windowEl.textContent =
    `${START.toLocaleDateString()} – ${e.toLocaleDateString()}`;
}

load();
</script>
</body>
</html>
