<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Operation On-Time — Mission Control</title>

<style>
:root{
  --bg1:#0b1022;
  --bg2:#0b2a3a;
  --bg3:#1a3b7a;
  --card: rgba(255,255,255,.06);
  --stroke: rgba(255,255,255,.12);
  --text:#eaf0ff;
  --muted:#b7c4ff;
  --muted2:#9aa7c7;
  --g1:#22d3ee;
  --g2:#60a5fa;
  --g3:#a78bfa;
  --shadow: 0 30px 80px rgba(0,0,0,.45);
}

*{ box-sizing:border-box; }

body{
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  color:var(--text);
  background:
    radial-gradient(1200px 800px at 20% 10%, rgba(96,165,250,.35), transparent 60%),
    radial-gradient(900px 700px at 80% 20%, rgba(167,139,250,.25), transparent 55%),
    linear-gradient(135deg, var(--bg3), var(--bg2), var(--bg1));
  min-height:100vh;
  padding:40px 16px;
  display:flex;
  justify-content:center;
}

.wrap{
  width:100%;
  max-width:720px;
  display:grid;
  gap:14px;
}

/* HEADER */
.top{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:18px;
  border-radius:18px;
  background:var(--card);
  border:1px solid var(--stroke);
  box-shadow:var(--shadow);
}

.brand{ display:flex; gap:14px; align-items:center; }

.logo{
  width:54px;height:54px;border-radius:16px;
  background:linear-gradient(135deg, rgba(34,211,238,.25), rgba(96,165,250,.25), rgba(167,139,250,.25));
  display:flex;align-items:center;justify-content:center;
}

.logo img{ width:100%;height:100%;object-fit:contain;padding:6px; }

h1{ margin:0;font-size:20px; }
.sub{ font-size:13px;color:var(--muted);margin-top:4px; }

.pill{
  font-size:12px;padding:8px 10px;border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.18);
  color:var(--muted);
}

/* CARD */
.card{
  padding:18px;
  border-radius:18px;
  background:var(--card);
  border:1px solid var(--stroke);
  box-shadow:var(--shadow);
}

/* STATS */
.stats{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:10px;
  margin-bottom:14px;
}

.stat{
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(135deg, rgba(96,165,250,.12), rgba(167,139,250,.10));
}

.k{ font-size:12px;color:var(--muted2); }
.v{ font-size:18px;font-weight:900;margin-top:6px; }

/* PROGRESS */
.bar{
  height:16px;border-radius:999px;
  background:rgba(255,255,255,.12);
  overflow:hidden;border:1px solid rgba(255,255,255,.12);
}

.fill{
  height:100%;width:0%;
  background:linear-gradient(90deg,var(--g1),var(--g2),var(--g3));
  transition:width .4s ease;
}

.status{
  margin-top:12px;
  padding:10px;
  text-align:center;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background:linear-gradient(135deg, rgba(34,211,238,.10), rgba(96,165,250,.10));
  font-weight:700;
}

.buffer{
  margin-top:6px;
  text-align:center;
  font-size:13px;
  color:var(--muted);
}

/* CALENDAR */
.week-head{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  margin-top:14px;
}

.week-head div{
  text-align:center;
  font-size:11px;
  color:var(--muted2);
}

.calendar{
  display:grid;
  grid-template-columns:repeat(7,1fr);
  gap:8px;
  margin-top:6px;
}

.day{
  padding:12px 8px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
  text-align:center;
  font-weight:800;
}

.rest{ opacity:.5; }

.checked{
  background:linear-gradient(135deg, rgba(34,211,238,.95), rgba(96,165,250,.92));
  color:#07101a;
}

.today{
  outline:2px solid rgba(34,211,238,.6);
  outline-offset:2px;
}
</style>
</head>

<body>
<div class="wrap">

<div class="top">
  <div class="brand">
    <div class="logo"><img src="logo.png"></div>
    <div>
      <h1>Operation On-Time</h1>
      <div class="sub">Mission Control · Shared progress</div>
    </div>
  </div>
  <div class="pill" id="window"></div>
</div>

<div class="card">
  <div class="stats">
    <div class="stat"><div class="k">On-time days</div><div class="v" id="count"></div></div>
    <div class="stat"><div class="k">Goal</div><div class="v">35</div></div>
    <div class="stat"><div class="k">Rest days</div><div class="v">Fri + Shabbat</div></div>
  </div>

  <div class="bar"><div class="fill" id="fill"></div></div>
  <div class="status" id="status"></div>
  <div class="buffer" id="buffer"></div>

  <div class="week-head">
    <div>Sun</div><div>Mon</div><div>Tue</div>
    <div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
  </div>

  <div class="calendar" id="cal"></div>
</div>

</div>

<script>
const START = new Date("2026-01-12");
const DAYS = 40;
const GOAL = 35;

const cal = document.getElementById("cal");
const count = document.getElementById("count");
const fill = document.getElementById("fill");
const status = document.getElementById("status");
const buffer = document.getElementById("buffer");
const windowPill = document.getElementById("window");

function endDate(){
  const e = new Date(START);
  e.setDate(e.getDate()+DAYS-1);
  return e;
}

function build(checked){
  cal.innerHTML="";
  const offset = START.getDay();
  for(let i=0;i<offset;i++){
    const s=document.createElement("div");
    s.style.visibility="hidden";
    cal.appendChild(s);
  }

  const todayKey = new Date().toISOString().slice(0,10);

  for(let i=0;i<DAYS;i++){
    const d=new Date(START);
    d.setDate(d.getDate()+i);
    const key=d.toISOString().slice(0,10);

    const div=document.createElement("div");
    div.className="day"+
      (checked.includes(key)?" checked":"")+
      (key===todayKey?" today":"")+
      ((d.getDay()==5||d.getDay()==6)?" rest":"");

    div.textContent=d.getDate();
    cal.appendChild(div);
  }
}

async function load(){
  const r=await fetch("progress.json?t="+Date.now());
  const j=await r.json();
  const checked=j.checkedDays||[];

  count.textContent=`${checked.length} / ${GOAL}`;
  fill.style.width=Math.min(100,(checked.length/GOAL)*100)+"%";
  status.textContent="⚡ In progress";

  const daysElapsed=Math.min(DAYS,
    Math.floor((Date.now()-START)/(1000*60*60*24))+1
  );
  const bufferLeft=Math.max(0,(DAYS-GOAL)-(daysElapsed-checked.length));
  buffer.textContent=`Buffer remaining: ${bufferLeft} days`;

  build(checked);
  const e=endDate();
  windowPill.textContent=`Window: ${START.toLocaleDateString()} → ${e.toLocaleDateString()}`;
}

load();
</script>
</body>
</html>
